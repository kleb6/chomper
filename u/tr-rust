#!/usr/bin/env raku
use lib 'rust';
use rust-grammar2;

use Data::Dump::Tree;

sub MAIN(:$stdin = Nil) {

    my $in = $stdin 
        ?? $stdin.IO.slurp.chomp 
        !! $*IN.slurp.chomp;

    $in = $in.subst(/^\s+/,"");

    my $rule = "TOP";

    my $actions = Nil;

    my $parsed = 
    Rust::Grammar.parse($in, :$rule, :$actions) 
    // 
    Rust::GrammarD.parse($in, :$rule, :$actions);

    if $parsed {

        say $parsed;

        my $made = $parsed.made;

        ddt $made;

        for $made.List {
            say $_.gist;
        }
    }
}
